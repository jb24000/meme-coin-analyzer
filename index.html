<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Meme Coin Analyzer Pro</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #2563eb;
            --secondary-blue: #1e40af;
            --light-blue: #3b82f6;
            --accent-blue: #60a5fa;
            --dark-gray: #1f2937;
            --medium-gray: #374151;
            --light-gray: #6b7280;
            --bg-gray: #f8fafc;
            --border-gray: #e5e7eb;
            --success-green: #10b981;
            --warning-orange: #f59e0b;
            --error-red: #ef4444;
            --white: #ffffff;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, var(--bg-gray) 0%, #e2e8f0 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark-gray);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 16px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            overflow: hidden;
            border: 1px solid var(--border-gray);
        }

        .header {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: var(--white);
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.3;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 12px;
            letter-spacing: -0.025em;
        }

        .header p {
            font-size: 1.125rem;
            opacity: 0.9;
            font-weight: 400;
        }

        .main-content {
            padding: 40px;
        }

        .api-status {
            background: var(--bg-gray);
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--error-red);
        }

        .status-dot.connected {
            background: var(--success-green);
        }

        .status-text {
            font-size: 0.875rem;
            color: var(--medium-gray);
        }

        .setup-apis {
            background: linear-gradient(135deg, var(--warning-orange), #f97316);
            color: white;
            padding: 12px 24px;
            border-radius: 6px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.875rem;
        }

        .input-section {
            background: var(--bg-gray);
            border: 1px solid var(--border-gray);
            border-radius: 12px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .input-group {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 16px;
            align-items: center;
        }

        .input-group input {
            padding: 16px 20px;
            border: 2px solid var(--border-gray);
            border-radius: 8px;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            background: var(--white);
            color: var(--dark-gray);
        }

        .input-group input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .analyze-btn {
            background: linear-gradient(135deg, var(--primary-blue), var(--light-blue));
            color: var(--white);
            border: none;
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .analyze-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .analyze-btn:disabled {
            background: var(--light-gray);
            cursor: not-allowed;
            transform: none;
        }

        .results {
            display: none;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .score-overview {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 32px;
        }

        .score-card {
            background: linear-gradient(135deg, var(--primary-blue), var(--accent-blue));
            border-radius: 12px;
            padding: 32px;
            text-align: center;
            color: var(--white);
            box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.3);
        }

        .score-value {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 8px;
            line-height: 1;
        }

        .score-label {
            font-size: 1.125rem;
            margin-bottom: 16px;
            font-weight: 500;
            opacity: 0.9;
        }

        .risk-level {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .metric-card {
            background: var(--white);
            border: 1px solid var(--border-gray);
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        .metric-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .metric-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 18px;
        }

        .metric-title {
            font-weight: 600;
            color: var(--dark-gray);
            font-size: 1rem;
        }

        .metric-value {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--primary-blue);
        }

        .metric-description {
            color: var(--light-gray);
            font-size: 0.875rem;
            line-height: 1.5;
        }

        .api-integration-section {
            background: var(--bg-gray);
            border: 1px solid var(--border-gray);
            border-radius: 12px;
            padding: 28px;
            margin-bottom: 32px;
        }

        .integration-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--dark-gray);
            margin-bottom: 16px;
        }

        .api-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .api-card {
            background: var(--white);
            border: 1px solid var(--border-gray);
            border-radius: 8px;
            padding: 16px;
            text-align: center;
        }

        .api-logo {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            margin: 0 auto 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-blue);
            color: white;
            font-weight: bold;
            font-size: 14px;
        }

        .api-name {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 4px;
        }

        .api-status-text {
            font-size: 0.75rem;
            color: var(--light-gray);
        }

        .setup-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: var(--white);
            border-radius: 16px;
            padding: 32px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            margin: 20px;
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark-gray);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--light-gray);
        }

        .api-setup-form {
            display: grid;
            gap: 16px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--medium-gray);
            margin-bottom: 6px;
        }

        .form-input {
            padding: 12px 16px;
            border: 1px solid var(--border-gray);
            border-radius: 6px;
            font-size: 14px;
            background: var(--white);
            color: var(--dark-gray);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
        }

        .save-keys-btn {
            background: var(--success-green);
            color: var(--white);
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 16px;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: var(--light-gray);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-gray);
            border-top: 3px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .disclaimer {
            background: linear-gradient(135deg, var(--medium-gray), var(--dark-gray));
            color: var(--white);
            padding: 24px;
            border-radius: 12px;
            margin-top: 32px;
        }

        .error-message {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: var(--error-red);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.875rem;
        }

        .success-message {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: var(--success-green);
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.875rem;
        }

        .github-link {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--dark-gray);
            color: var(--white);
            padding: 12px;
            border-radius: 50%;
            text-decoration: none;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .github-link:hover {
            background: var(--medium-gray);
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .score-overview {
                grid-template-columns: 1fr;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>üéØ Meme Coin Analyzer Pro</h1>
                <p>Professional-grade risk assessment with real-time blockchain data</p>
            </div>
        </div>

        <div class="main-content">
            <!-- API Status Section -->
            <div class="api-status">
                <div class="status-indicator">
                    <div class="status-dot" id="apiStatusDot"></div>
                    <span class="status-text" id="apiStatusText">APIs not configured - Using demo data</span>
                </div>
                <button class="setup-apis" onclick="showSetupModal()">Configure APIs</button>
            </div>

            <!-- API Integration Overview -->
            <div class="api-integration-section">
                <div class="integration-title">üîå Connected Data Sources</div>
                <div class="api-grid">
                    <div class="api-card">
                        <div class="api-logo">DX</div>
                        <div class="api-name">DexScreener</div>
                        <div class="api-status-text" id="dexscreener-status">Not connected</div>
                    </div>
                    <div class="api-card">
                        <div class="api-logo">ES</div>
                        <div class="api-name">Etherscan</div>
                        <div class="api-status-text" id="etherscan-status">Not connected</div>
                    </div>
                    <div class="api-card">
                        <div class="api-logo">CG</div>
                        <div class="api-name">CoinGecko</div>
                        <div class="api-status-text" id="coingecko-status">Not connected</div>
                    </div>
                    <div class="api-card">
                        <div class="api-logo">TW</div>
                        <div class="api-name">Twitter</div>
                        <div class="api-status-text" id="twitter-status">Not connected</div>
                    </div>
                </div>
            </div>

            <div class="input-section">
                <div class="input-group">
                    <input type="text" id="coinAddress" placeholder="Enter token contract address..." />
                    <button class="analyze-btn" id="analyzeBtn" onclick="analyzeCoin()">
                        <span id="btnText">Analyze Token</span>
                    </button>
                </div>
            </div>

            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Fetching real-time blockchain data and analyzing token metrics...</p>
            </div>

            <div id="results" class="results">
                <div class="score-overview">
                    <div class="score-card">
                        <div class="score-value" id="overallScore">--</div>
                        <div class="score-label">Overall Score</div>
                        <div class="risk-level" id="riskLevel">Analyzing...</div>
                    </div>
                    <div class="score-card" style="background: linear-gradient(135deg, var(--success-green), #059669);">
                        <div class="score-value" id="confidenceScore">--</div>
                        <div class="score-label">Confidence Level</div>
                        <div class="risk-level" style="background: rgba(255, 255, 255, 0.2); color: #d1fae5;">Based on data quality</div>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon" style="background: rgba(37, 99, 235, 0.1); color: var(--primary-blue);">üîí</div>
                            <div class="metric-title">Liquidity Security</div>
                        </div>
                        <div class="metric-value" id="liquidityScore">--/100</div>
                        <div class="metric-description" id="liquidityDesc">
                            Analyzing liquidity locks and rug pull risks...
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon" style="background: rgba(16, 185, 129, 0.1); color: var(--success-green);">üõ°Ô∏è</div>
                            <div class="metric-title">Contract Security</div>
                        </div>
                        <div class="metric-value" id="securityScore">--/100</div>
                        <div class="metric-description" id="securityDesc">
                            Checking contract verification and security features...
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon" style="background: rgba(245, 158, 11, 0.1); color: var(--warning-orange);">üëë</div>
                            <div class="metric-title">Smart Money Activity</div>
                        </div>
                        <div class="metric-value" id="smartMoneyScore">--/100</div>
                        <div class="metric-description" id="smartMoneyDesc">
                            Tracking successful trader wallet activity...
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon" style="background: rgba(139, 92, 246, 0.1); color: #8b5cf6;">üìà</div>
                            <div class="metric-title">Social Sentiment</div>
                        </div>
                        <div class="metric-value" id="socialScore">--/100</div>
                        <div class="metric-description" id="socialDesc">
                            Analyzing social media sentiment and engagement...
                        </div>
                    </div>
                </div>

                <div id="analysisDetails" style="display: none;">
                    <!-- Detailed analysis will be shown here -->
                </div>
            </div>

            <div class="disclaimer">
                <h3>‚ö†Ô∏è Professional Disclaimer</h3>
                <p>This tool provides analysis for educational purposes only. Cryptocurrency investments are extremely high-risk. Always do your own research and never invest more than you can afford to lose completely. The analysis may contain errors and should not be considered financial advice.</p>
            </div>
        </div>
    </div>

    <!-- Setup Modal -->
    <div class="setup-modal" id="setupModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üîß API Configuration</div>
                <button class="close-modal" onclick="hideSetupModal()">&times;</button>
            </div>
            
            <div id="modalMessages"></div>
            
            <div class="api-setup-form">
                <div class="form-group">
                    <label class="form-label">DexScreener API Key</label>
                    <input type="password" class="form-input" id="dexscreenerKey" placeholder="Get free key from dexscreener.com/api">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Etherscan API Key</label>
                    <input type="password" class="form-input" id="etherscanKey" placeholder="Get free key from etherscan.io/apis">
                </div>
                
                <div class="form-group">
                    <label class="form-label">CoinGecko API Key (Optional)</label>
                    <input type="password" class="form-input" id="coingeckoKey" placeholder="Optional - for enhanced market data">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Twitter Bearer Token (Optional)</label>
                    <input type="password" class="form-input" id="twitterToken" placeholder="Optional - for social sentiment analysis">
                </div>
                
                <button class="save-keys-btn" onclick="saveAPIKeys()">Save Configuration</button>
            </div>
            
            <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border-gray);">
                <h4 style="margin-bottom: 12px; color: var(--dark-gray);">üìö How to get API keys:</h4>
                <ul style="color: var(--light-gray); font-size: 0.875rem; line-height: 1.5;">
                    <li><strong>DexScreener:</strong> Visit <a href="https://dexscreener.com/api" target="_blank">dexscreener.com/api</a> - Free tier: 300 req/min</li>
                    <li><strong>Etherscan:</strong> Visit <a href="https://etherscan.io/apis" target="_blank">etherscan.io/apis</a> - Free tier: 5 req/sec</li>
                    <li><strong>CoinGecko:</strong> Visit <a href="https://www.coingecko.com/en/api/pricing" target="_blank">coingecko.com/api</a> - Free tier available</li>
                    <li><strong>Twitter:</strong> Visit <a href="https://developer.twitter.com/" target="_blank">developer.twitter.com</a> - Free tier available</li>
                </ul>
            </div>
        </div>
    </div>

    <a href="https://github.com/yourusername/meme-coin-analyzer" class="github-link" target="_blank">
        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"/>
        </svg>
    </a>

    <script>
        // API Configuration Management
        class APIManager {
            constructor() {
                this.apis = {
                    dexscreener: { key: null, status: 'disconnected' },
                    etherscan: { key: null, status: 'disconnected' },
                    coingecko: { key: null, status: 'disconnected' },
                    twitter: { key: null, status: 'disconnected' }
                };
                this.loadConfiguration();
                this.updateStatusDisplay();
            }
            
            loadConfiguration() {
                const config = JSON.parse(localStorage.getItem('apiConfig') || '{}');
                Object.keys(this.apis).forEach(api => {
                    if (config[api]) {
                        this.apis[api].key = config[api];
                        this.apis[api].status = 'connected';
                    }
                });
            }
            
            saveConfiguration(newConfig) {
                const config = {};
                Object.keys(newConfig).forEach(api => {
                    if (newConfig[api]) {
                        this.apis[api].key = newConfig[api];
                        this.apis[api].status = 'connected';
                        config[api] = newConfig[api];
                    }
                });
                localStorage.setItem('apiConfig', JSON.stringify(config));
                this.updateStatusDisplay();
            }
            
            updateStatusDisplay() {
                const connectedAPIs = Object.values(this.apis).filter(api => api.status === 'connected').length;
                const statusDot = document.getElementById('apiStatusDot');
                const statusText = document.getElementById('apiStatusText');
                
                if (connectedAPIs > 0) {
                    statusDot.classList.add('connected');
                    statusText.textContent = `${connectedAPIs} API${connectedAPIs > 1 ? 's' : ''} connected - Real data available`;
                } else {
                    statusDot.classList.remove('connected');
                    statusText.textContent = 'APIs not configured - Using demo data';
                }
                
                // Update individual API status
                Object.keys(this.apis).forEach(api => {
                    const statusElement = document.getElementById(`${api}-status`);
                    if (statusElement) {
                        statusElement.textContent = this.apis[api].status === 'connected' ? 'Connected' : 'Not connected';
                        statusElement.style.color = this.apis[api].status === 'connected' ? 'var(--success-green)' : 'var(--light-gray)';
                    }
                });
            }
            
            isConnected(api) {
                return this.apis[api] && this.apis[api].status === 'connected';
            }
            
            getKey(api) {
                return this.apis[api]?.key;
            }
        }

        // Real API Integration Classes
        class DexScreenerAPI {
            constructor(apiKey) {
                this.apiKey = apiKey;
                this.baseUrl = 'https://api.dexscreener.com/latest';
            }
            
            async getTokenData(contractAddress) {
                const response = await fetch(`${this.baseUrl}/dex/tokens/${contractAddress}`, {
                    headers: this.apiKey ? { 'X-API-Key': this.apiKey } : {}
                });
                
                if (!response.ok) {
                    throw new Error(`DexScreener API error: ${response.status}`);
                }
                
                return await response.json();
            }
        }

        class EtherscanAPI {
            constructor(apiKey) {
                this.apiKey = apiKey;
                this.baseUrl = 'https://api.etherscan.io/api';
            }
            
            async getContractInfo(contractAddress) {
                const response = await fetch(`${this.baseUrl}?module=contract&action=getsourcecode&address=${contractAddress}&apikey=${this.apiKey}`);
                
                if (!response.ok) {
                    throw new Error(`Etherscan API error: ${response.status}`);
                }
                
                return await response.json();
            }
            
            async getTokenInfo(contractAddress) {
                const response = await fetch(`${this.baseUrl}?module=token&action=tokeninfo&contractaddress=${contractAddress}&apikey=${this.apiKey}`);
                
                if (!response.ok) {
                    throw new Error(`Etherscan API error: ${response.status}`);
                }
                
                return await response.json();
            }
        }

        // Advanced Analysis Engine
        class TokenAnalyzer {
            constructor(apiManager) {
                this.apiManager = apiManager;
                this.dexScreener = new DexScreenerAPI(apiManager.getKey('dexscreener'));
                this.etherscan = new EtherscanAPI(apiManager.getKey('etherscan'));
            }
            
            async analyzeToken(contractAddress) {
                const analysis = {
                    contractAddress,
                    timestamp: Date.now(),
                    dataQuality: 0,
                    sources: [],
                    scores: {},
                    details: {}
                };
                
                try {
                    // DexScreener Analysis
                    if (this.apiManager.isConnected('dexscreener')) {
                        const dexData = await this.dexScreener.getTokenData(contractAddress);
                        analysis.sources.push('DexScreener');
                        analysis.details.dexData = dexData;
                        analysis.scores.liquidity = this.calculateLiquidityScore(dexData);
                        analysis.dataQuality += 30;
                    }
                    
                    // Etherscan Analysis
                    if (this.apiManager.isConnected('etherscan')) {
                        const contractInfo = await this.etherscan.getContractInfo(contractAddress);
                        analysis.sources.push('Etherscan');
                        analysis.details.contractInfo = contractInfo;
                        analysis.scores.security = this.calculateSecurityScore(contractInfo);
                        analysis.dataQuality += 25;
                    }
                    
                    // Calculate composite scores
                    analysis.scores.overall = this.calculateOverallScore(analysis.scores);
                    analysis.confidence = Math.min(100, analysis.dataQuality);
                    
                    return analysis;
                    
                } catch (error) {
                    console.error('Analysis failed:', error);
                    throw error;
                }
            }
            
            calculateLiquidityScore(dexData) {
                if (!dexData?.pairs?.[0]) return 0;
                
                const pair = dexData.pairs[0];
                const liquidity = pair.liquidity?.usd || 0;
                const locked = pair.liquidity?.locked || false;
                
                let score = Math.min(50, Math.log10(liquidity) * 10); // Base score from liquidity amount
                
                if (locked) {
                    score += 30; // Bonus for locked liquidity
                }
                
                // Additional factors
                if (pair.volume?.h24 > liquidity * 0.1) {
                    score += 10; // Good volume relative to liquidity
                }
                
                return Math.min(100, Math.max(0, score));
            }
            
            calculateSecurityScore(contractInfo) {
                if (!contractInfo?.result?.[0]) return 0;
                
                const contract = contractInfo.result[0];
                let score = 0;
                
                // Contract verification
                if (contract.SourceCode && contract.SourceCode !== '') {
                    score += 40;
                }
                
                // Compiler version (newer is generally better)
                if (contract.CompilerVersion && contract.CompilerVersion.includes('0.8')) {
                    score += 20;
                }
                
                // Optimization used
                if (contract.OptimizationUsed === '1') {
                    score += 15;
                }
                
                // Not a proxy contract (generally safer)
                if (!contract.Proxy || contract.Proxy === '0') {
                    score += 25;
                }
                
                return Math.min(100, score);
            }
            
            calculateOverallScore(scores) {
                const weights = {
                    liquidity: 0.35,
                    security: 0.30,
                    smartMoney: 0.20,
                    social: 0.15
                };
                
                let weightedSum = 0;
                let totalWeight = 0;
                
                Object.keys(weights).forEach(factor => {
                    if (scores[factor] !== undefined) {
                        weightedSum += scores[factor] * weights[factor];
                        totalWeight += weights[factor];
                    }
                });
                
                return totalWeight > 0 ? Math.round(weightedSum / totalWeight) : 0;
            }
        }

        // Initialize the application
        const apiManager = new APIManager();
        const tokenAnalyzer = new TokenAnalyzer(apiManager);

        // UI Functions
        function showSetupModal() {
            document.getElementById('setupModal').style.display = 'flex';
        }

        function hideSetupModal() {
            document.getElementById('setupModal').style.display = 'none';
        }

        function showMessage(message, type = 'info') {
            const messagesDiv = document.getElementById('modalMessages');
            const messageClass = type === 'error' ? 'error-message' : 'success-message';
            messagesDiv.innerHTML = `<div class="${messageClass}">${message}</div>`;
            
            setTimeout(() => {
                messagesDiv.innerHTML = '';
            }, 5000);
        }

        function saveAPIKeys() {
            const config = {
                dexscreener: document.getElementById('dexscreenerKey').value.trim(),
                etherscan: document.getElementById('etherscanKey').value.trim(),
                coingecko: document.getElementById('coingeckoKey').value.trim(),
                twitter: document.getElementById('twitterToken').value.trim()
            };
            
            // Validate required keys
            if (!config.dexscreener && !config.etherscan) {
                showMessage('Please provide at least one API key (DexScreener or Etherscan) for basic functionality.', 'error');
                return;
            }
            
            apiManager.saveConfiguration(config);
            showMessage('API configuration saved successfully! You can now analyze tokens with real data.', 'success');
            
            // Clear form
            Object.keys(config).forEach(key => {
                document.getElementById(key + 'Key').value = '';
            });
            
            setTimeout(() => {
                hideSetupModal();
            }, 2000);
        }

        async function analyzeCoin() {
            const coinAddress = document.getElementById('coinAddress').value.trim();
            
            if (!coinAddress) {
                alert('Please enter a token contract address');
                return;
            }

            if (!isValidAddress(coinAddress)) {
                alert('Please enter a valid contract address');
                return;
            }

            // Show loading state
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            document.getElementById('analyzeBtn').disabled = true;
            document.getElementById('btnText').textContent = 'Analyzing...';

            try {
                const analysis = await tokenAnalyzer.analyzeToken(coinAddress);
                
                // Cache analysis data for offline use
                pwaManager.cacheAnalysis(analysis);
                
                displayResults(analysis);
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('results').style.display = 'block';
                
            } catch (error) {
                console.error('Analysis failed:', error);
                
                // Check if we're offline and have cached data
                if (!navigator.onLine) {
                    const cachedData = await getCachedAnalysis(coinAddress);
                    if (cachedData) {
                        displayResults(cachedData);
                        showOfflineMessage();
                    } else {
                        const demoAnalysis = generateDemoAnalysis(coinAddress);
                        displayResults(demoAnalysis);
                        showOfflineMessage();
                    }
                } else {
                    // Fall back to demo data if real analysis fails
                    const demoAnalysis = generateDemoAnalysis(coinAddress);
                    displayResults(demoAnalysis);
                    
                    // Show error message
                    const resultsDiv = document.getElementById('results');
                    resultsDiv.insertAdjacentHTML('afterbegin', 
                        '<div class="error-message">‚ö†Ô∏è Unable to fetch real-time data. Showing demo analysis. Please configure APIs for accurate results.</div>'
                    );
                }
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('results').style.display = 'block';
            } finally {
                document.getElementById('analyzeBtn').disabled = false;
                document.getElementById('btnText').textContent = 'Analyze Token';
            }
        }

        async function getCachedAnalysis(contractAddress) {
            try {
                if ('caches' in window) {
                    const cache = await caches.open('meme-coin-analyzer-data-v1.0.0');
                    const response = await cache.match(`/analysis/${contractAddress}`);
                    if (response) {
                        return await response.json();
                    }
                }
            } catch (error) {
                console.error('Failed to get cached analysis:', error);
            }
            return null;
        }

        function showOfflineMessage() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.insertAdjacentHTML('afterbegin', 
                '<div class="error-message">üì± You\'re offline. Showing cached analysis data. Results will sync when connection is restored.</div>'
            );
        }

        function displayResults(analysis) {
            // Update scores
            document.getElementById('overallScore').textContent = analysis.scores.overall || '--';
            document.getElementById('confidenceScore').textContent = analysis.confidence || '--';
            
            // Update metrics
            document.getElementById('liquidityScore').textContent = `${analysis.scores.liquidity || 0}/100`;
            document.getElementById('securityScore').textContent = `${analysis.scores.security || 0}/100`;
            document.getElementById('smartMoneyScore').textContent = `${analysis.scores.smartMoney || 0}/100`;
            document.getElementById('socialScore').textContent = `${analysis.scores.social || 0}/100`;
            
            // Update descriptions
            updateDescriptions(analysis);
            
            // Update risk level
            updateRiskLevel(analysis.scores.overall || 0);
        }

        function updateDescriptions(analysis) {
            const liquidity = analysis.scores.liquidity || 0;
            const security = analysis.scores.security || 0;
            
            document.getElementById('liquidityDesc').textContent = 
                liquidity > 80 ? 'Excellent liquidity security detected. Low rug pull risk.' :
                liquidity > 60 ? 'Good liquidity management with adequate security measures.' :
                liquidity > 30 ? 'Moderate liquidity concerns. Review tokenomics carefully.' :
                'High liquidity risk detected. Exercise extreme caution.';

            document.getElementById('securityDesc').textContent = 
                security > 80 ? 'Contract is verified with strong security features.' :
                security > 60 ? 'Contract verification confirmed with standard security.' :
                security > 30 ? 'Basic contract security measures in place.' :
                'Contract security concerns detected. High risk.';

            document.getElementById('smartMoneyDesc').textContent = 
                analysis.sources.includes('DexScreener') ? 'Analyzing successful trader wallet activity...' :
                'Smart money tracking requires API configuration.';

            document.getElementById('socialDesc').textContent = 
                analysis.sources.includes('Twitter') ? 'Social sentiment analysis in progress...' :
                'Social analysis requires Twitter API configuration.';
        }

        function updateRiskLevel(score) {
            const riskLevel = document.getElementById('riskLevel');
            
            if (score >= 75) {
                riskLevel.textContent = 'Low Risk';
                riskLevel.style.background = 'rgba(16, 185, 129, 0.2)';
                riskLevel.style.color = '#10b981';
            } else if (score >= 50) {
                riskLevel.textContent = 'Medium Risk';
                riskLevel.style.background = 'rgba(245, 158, 11, 0.2)';
                riskLevel.style.color = '#f59e0b';
            } else {
                riskLevel.textContent = 'High Risk';
                riskLevel.style.background = 'rgba(239, 68, 68, 0.2)';
                riskLevel.style.color = '#ef4444';
            }
        }

        function generateDemoAnalysis(contractAddress) {
            return {
                contractAddress,
                timestamp: Date.now(),
                dataQuality: 20,
                sources: ['Demo'],
                scores: {
                    overall: Math.floor(Math.random() * 40) + 30,
                    liquidity: Math.floor(Math.random() * 50) + 25,
                    security: Math.floor(Math.random() * 60) + 20,
                    smartMoney: Math.floor(Math.random() * 80) + 10,
                    social: Math.floor(Math.random() * 70) + 15
                },
                confidence: 20,
                details: {
                    note: 'This is demo data. Configure APIs for real analysis.'
                }
            };
        }

        function isValidAddress(address) {
            return /^0x[a-fA-F0-9]{40}$/.test(address) || 
                   /^[1-9A-HJ-NP-Za-km-z]{32,44}$/.test(address) || 
                   address.length > 20;
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Check if APIs are configured on load
            const hasAPIs = Object.values(apiManager.apis).some(api => api.status === 'connected');
            
            if (!hasAPIs) {
                // Show a helpful message for first-time users
                setTimeout(() => {
                    const intro = confirm('Welcome to Meme Coin Analyzer Pro! To get accurate analysis with real blockchain data, you\'ll need to configure API keys. Would you like to set them up now? (Click Cancel to try with demo data first)');
                    if (intro) {
                        showSetupModal();
                    }
                }, 1000);
            }
        });

        // Enter key support
        document.getElementById('coinAddress').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzeCoin();
            }
        });

        // Close modal when clicking outside
        document.getElementById('setupModal').addEventListener('click', function(e) {
            if (e.target === this) {
                hideSetupModal();
            }
        });
    </script>
</body>
</html>
